{"version":3,"sources":["scripts/main.js"],"names":["newTable","button","document","querySelector","gameScore","fieldRows","querySelectorAll","msStart","msLose","msWin","table","tableLength","length","SCORE","WIN_SCORE","isWin","addNumber","emptyCells","forEach","r","rIndex","cell","cIndex","push","Math","floor","random","randomY","randomX","buildCell","c","element","children","textContent","className","move","e","key","moveLeft","moveRight","moveDown","moveUp","JSON","stringify","classList","remove","checkMove","add","removeEventListener","reset","map","y","msg","reverseRows","reverse","checkRows","newY","filter","reduce","acc","concat","Array","fill","movingField","checkColumns","some","x","includes","_","xIndex","addEventListener","contains","toggle","innerText"],"mappings":"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","file":"main.35de4e7d.js","sourceRoot":"..\\src","sourcesContent":["'use strict';\n\nconst button = document.querySelector('button');\nconst gameScore = document.querySelector('.game-score');\nconst fieldRows = document.querySelectorAll('.field-row');\nconst msStart = document.querySelector('.message-start');\nconst msLose = document.querySelector('.message-lose');\nconst msWin = document.querySelector('.message-win');\n\nlet newTable;\nlet table = [\n  [0, 0, 0, 0],\n  [0, 0, 0, 0],\n  [0, 0, 0, 0],\n  [0, 0, 0, 0],\n];\n\nconst tableLength = table.length;\nlet SCORE = 0;\nconst WIN_SCORE = 2048;\nlet isWin = false;\n\nbutton.addEventListener('click', () => {\n  document.addEventListener('keydown', move);\n\n  if (button.classList.contains('start')) {\n    button.classList.toggle('start');\n    button.classList.toggle('restart');\n    button.innerText = 'Restart';\n    msStart.classList.add('hidden');\n  } else {\n    isWin = false;\n    reset();\n  }\n\n  addNumber();\n  addNumber();\n  buildCell();\n});\n\nfunction addNumber() {\n  const emptyCells = [];\n\n  table.forEach((r, rIndex) =>\n    r.forEach((cell, cIndex) =>\n      cell === 0 && emptyCells.push([rIndex, cIndex])\n    )\n  );\n\n  const [randomY, randomX]\n    = emptyCells[Math.floor(Math.random() * emptyCells.length)];\n\n  table[randomY][randomX] = Math.random() < 0.9 ? 2 : 4;\n}\n\nfunction buildCell() {\n  for (let r = 0; r < tableLength; r++) {\n    for (let c = 0; c < tableLength; c++) {\n      const element = fieldRows[r].children[c]; // html .field-cell\n      const cell = table[r][c]; // Значення кожної клітинки\n\n      element.textContent = cell || '';\n\n      element.className\n        = `field-cell ${cell ? `field-cell--${cell}` : ''}`;\n    }\n  }\n\n  gameScore.textContent = SCORE;\n}\n\nfunction move(e) {\n  newTable = table;\n\n  switch (e.key) {\n    case 'ArrowLeft':\n      moveLeft();\n      break;\n\n    case 'ArrowRight':\n      moveRight();\n      break;\n\n    case 'ArrowDown':\n      moveDown();\n      break;\n\n    case 'ArrowUp':\n      moveUp();\n      break;\n\n    default:\n      return;\n  }\n\n  if (JSON.stringify(newTable) !== JSON.stringify(table)) {\n    table = newTable;\n    addNumber();\n    buildCell();\n  }\n\n  if (isWin) {\n    msWin.classList.remove('hidden');\n  }\n\n  if (!checkMove()) {\n    msLose.classList.remove('hidden');\n    msWin.classList.add('hidden');\n    document.removeEventListener('keydown', move);\n  }\n}\n\nfunction reset() {\n  table = table.map((y) => y.map(() => 0));\n  SCORE = 0;\n\n  [msWin, msLose].forEach(msg => msg.classList.add('hidden'));\n}\n\nfunction reverseRows() {\n  newTable.forEach(y => y.reverse());\n}\n\nfunction moveLeft() {\n  if (!checkRows()) {\n    return;\n  }\n\n  newTable = newTable.map(y => {\n    const newY\n      = y.filter(cell => cell !== 0)\n        .reduce((acc, cell) => {\n          const preCell = acc[acc.length - 1];\n\n          if (preCell === cell) {\n            acc[acc.length - 1] *= 2;\n            SCORE += acc[acc.length - 1];\n\n            if (acc[acc.length - 1] === WIN_SCORE) {\n              isWin = true;\n            }\n          } else {\n            acc.push(cell);\n          }\n\n          return acc;\n        }, []);\n\n    return newY.concat(Array(tableLength - newY.length).fill(0));\n  });\n}\n\nfunction moveRight() {\n  if (!checkRows()) {\n    return;\n  }\n\n  reverseRows();\n  moveLeft();\n  reverseRows();\n}\n\nfunction moveDown() {\n  movingField();\n  moveRight();\n  movingField();\n}\n\nfunction moveUp() {\n  movingField();\n  moveLeft();\n  movingField();\n}\n\nfunction checkColumns() {\n  return newTable.some(y =>\n    y.some((cell, x) => cell === y[x + 1])\n  );\n}\n\nfunction checkRows() {\n  return newTable.some(y =>\n    y.some((cell, x) => cell === y[x + 1]) || y.includes(0)\n  );\n}\n\nfunction movingField() {\n  newTable\n    = newTable[0].map((_, xIndex) =>\n      newTable.map(y => y[xIndex])\n    );\n}\n\nfunction checkMove() {\n  return checkRows() || (movingField(), checkColumns());\n}\n"]}